# SyncWrapperAPI

## Цель:

Реализовать веб-сервис (только API) для перевода текстов, проксирующий наш [intento API](https://github.com/intento/intento-api) для перевода. В зависимости от того, какой запрос (синк или асинк запрос), нужно проксировать по разному запрос.

## Глоссарий:

* API - Application Programming Interface
* SyncWrapperAPI -  API, который необходимо разработать.
* Intento API - [API платформы](https://github.com/intento/intento-api)
* Синк запрос (без `async:true`) - запрос в результате, которого приходит перевод.
* Асинк запрос (с `async:true`) - запрос в результате, которого приходит id отложенной задачи. Для получения результата нужно полить ресурс до момента, когда он будет готов.

Для более детального описания и конкретных ключей обращайтесь к [документации API]().

## Логика:
* Синк запрос просто проксировать без изменений.
* Асинк запрос выглядит для клиента, как синк. Проксирования запроса и поллинг результатов происходит в одном соединение для клиента (время жизни соединения <120сек). Общий процесс:
  * Асинк запрос приходит в SyncWrapperAPI сервис, запрос проксируется в Intento API, но клиентское соединение не закрывается. От Intento API приходит id отложенных ресурсов, который полится на стороне SyncWrapperAPI сервиса до момента, когда будет результат. Этот результат отдается клиенту в первоначальном соединении. 

## Критерий приемки:

1. SyncWrapperAPI должен работать только с путем `/ai/text/translate/`. Запросы с другими путями должны проксироваться без изменений и проверки синк/асинк. Все дальнейшие пункты относятся только к  `/ai/text/translate/`.
2. Синк запрос должен проксироваться без изменений.
3. Асинк запрос для клиента должен выглядить, как синхронный. 
4. Спека возвращаемого ответа для обоих типов запросов (Пример возвращаемого ответа ниже от SyncWrapperApi).
5. Если запрос невалидный, то ошибки проксируются клиенту от IntentoAPI.
6. При проксировании первоначальный User-Agent должен видоизменяться: в конце добавляться строка /SyncWrapperAPI


### Пример возвращаемого ответа от SyncWrapperApi
```
{
    "results": [ "Translated large text corpus" ],
    "meta": {},
    "service": { 
        "provider": { 
            "id": "ai.text.translate.microsoft.translator_text_api.3-0", 
            "name": "Microsoft Translator API v3.0" 
            } 
    },
    “op_id”: operation_id
}
```

## Технические требования
* Python 3.7
* Aiohttp последняя версия
* Dockerized application - ready to run
* Финальная версия должна быть выложена в github
* Грамотный/красивый код)
